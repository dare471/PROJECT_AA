{"version":3,"file":"index-5ef46d0e.js","sources":["../../src/entities/user/model/user-map-histories.ts","../../src/entities/user/ui/user-map-history-card.tsx","../../src/pages/settings-profile/model.ts","../../src/pages/settings-profile/page.tsx"],"sourcesContent":["import { attach, createStore } from 'effector'\n\nimport { userApi, type UserMapHistory } from '~src/shared/api'\n\nexport function createUserMapHistories() {\n\tconst $userMapHistories = createStore<UserMapHistory[]>([])\n\tconst $userMapHistoriesPending = createStore<boolean>(false)\n\n\tconst getUserMapHistoriesFx = attach({\n\t\teffect: userApi.userMapHistoriesQuery,\n\t})\n\n\t$userMapHistoriesPending.on(getUserMapHistoriesFx.pending, (_, pending) => pending)\n\t$userMapHistories.on(getUserMapHistoriesFx.doneData, (_, userMapHistories) => userMapHistories)\n\n\treturn {\n\t\tgetUserMapHistoriesFx,\n\t\t$userMapHistories,\n\t\t$userMapHistoriesPending,\n\t}\n}\n","import { Card, CardBody, type CardProps, Grid, Stack, Text } from '@chakra-ui/react'\n\nimport { type UserMapHistory } from '~src/shared/api'\nimport { DescriptionText, Spin } from '~src/shared/ui'\n\nimport { type createUser } from '../model'\n\ninterface UserMapHistoryCardProps extends Partial<UserMapHistory>, Omit<CardProps, 'id' | 'onClick'> {\n\tindex: number\n\tload?: { loading: boolean; loader?: React.ReactNode }\n\tonClick?: (args: { event: any; id: string; clientId: number; regionId: number; plotId: number }) => void\n}\n\nexport function UserMapHistoryCard(props: UserMapHistoryCardProps) {\n\tconst {\n\t\tindex,\n\t\tid,\n\t\tuserId,\n\t\tclientId,\n\t\tclientName,\n\t\tregionId,\n\t\tregionName,\n\t\tplotId,\n\t\tplotName,\n\t\tload,\n\t\tonClick,\n\t\t...otherProps\n\t} = props\n\n\treturn (\n\t\t<Card {...otherProps}>\n\t\t\t<CardBody>\n\t\t\t\t<Stack>\n\t\t\t\t\t<DescriptionText title='Номер:'>{index}</DescriptionText>\n\t\t\t\t\t{clientName && (\n\t\t\t\t\t\t<Text fontSize='md' fontWeight='medium'>\n\t\t\t\t\t\t\t<DescriptionText title='Клиент:'>{clientName}</DescriptionText>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t)}\n\t\t\t\t\t{regionName && (\n\t\t\t\t\t\t<Text fontSize='md' fontWeight='medium'>\n\t\t\t\t\t\t\t<DescriptionText title='Область:'>{regionName}</DescriptionText>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t)}\n\t\t\t\t\t{plotName && (\n\t\t\t\t\t\t<Text fontSize='md' fontWeight='medium'>\n\t\t\t\t\t\t\t<DescriptionText title='Участок:'>{plotName}</DescriptionText>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t)}\n\t\t\t\t</Stack>\n\t\t\t</CardBody>\n\n\t\t\t{load && !load.loader ? <Spin /> : <>{load?.loader}</>}\n\t\t</Card>\n\t)\n}\n","import { createEvent, sample } from 'effector'\n\nimport { $$session } from '~src/entities/session'\nimport { createUserContracts, createUserMapHistories, UserFactory } from '~src/entities/user'\n\nimport { type Session } from '~src/shared/api'\nimport { createTabs } from '~src/shared/ui'\n\nexport const $settingsProfilePageMounted = createEvent<void>()\nexport const $settingsProfilePageUnmounted = createEvent<void>()\n\nexport const $$tabs = createTabs({\n\tdefaultTab: 'settings',\n\ttabs: ['settings', 'contracts'],\n})\n\nexport const $$user = UserFactory.createUser()\nexport const $$userMapHistories = createUserMapHistories()\nexport const $$userContracts = createUserContracts()\n\nsample({\n\tclock: $settingsProfilePageMounted,\n\tsource: $$session.$session,\n\tfilter: (session: Session | null): session is Session => session !== null,\n\tfn: (session) => ({ userId: session.id }),\n\ttarget: [$$user.getUserFx, $$userMapHistories.getUserMapHistoriesFx],\n})\n\nsample({\n\tclock: $settingsProfilePageUnmounted,\n\ttarget: [$$user.$user.reinit!, $$userMapHistories.$userMapHistories.reinit!],\n})\n","import { Stack } from '@chakra-ui/react'\nimport { useUnit } from 'effector-react'\nimport React from 'react'\n\nimport { UserMapHistoryCard } from '~src/entities/user'\nimport { UserCard } from '~src/entities/user/ui'\n\nimport { Pagination, Spin, usePagination } from '~src/shared/ui'\n\nimport * as model from './model'\n\nexport function SettingsProfilePage() {\n\tconst [handleMount, handleUnmount] = useUnit([model.$settingsProfilePageMounted, model.$settingsProfilePageUnmounted])\n\n\tReact.useEffect(() => {\n\t\thandleMount()\n\n\t\treturn () => {\n\t\t\thandleUnmount()\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [])\n\n\treturn (\n\t\t<Stack>\n\t\t\t<Stack minH='2xs' bgColor='whiteAlpha.300' rounded='md' boxShadow='md' px='4' py='5'>\n\t\t\t\t<User />\n\t\t\t</Stack>\n\t\t\t<Stack minH='md' bgColor='whiteAlpha.300' rounded='md' boxShadow='md' px='4' py='5'>\n\t\t\t\t<UserMapHistories />\n\t\t\t</Stack>\n\t\t</Stack>\n\t)\n}\n\nfunction UserMapHistories() {\n\tconst [userMapHistories, userMapHistoriesPending] = useUnit([\n\t\tmodel.$$userMapHistories.$userMapHistories,\n\t\tmodel.$$userMapHistories.$userMapHistoriesPending,\n\t])\n\tconst { maxPage, pages, currentData, currentPage, setCurrentPage } = usePagination({\n\t\tdata: userMapHistories,\n\t\tperPage: 5,\n\t\tmaxPages: 5,\n\t})\n\n\tif (userMapHistoriesPending) {\n\t\treturn <Spin />\n\t}\n\n\treturn (\n\t\t<Stack>\n\t\t\t{currentData.map((userMapHistory, index) => (\n\t\t\t\t<UserMapHistoryCard key={index} index={index} {...userMapHistory} />\n\t\t\t))}\n\t\t\t<Pagination\n\t\t\t\tpages={pages}\n\t\t\t\tcurrentPage={currentPage}\n\t\t\t\tonFirstClick={() => setCurrentPage(1)}\n\t\t\t\tonLastClick={() => setCurrentPage(maxPage)}\n\t\t\t\tonPageChange={(page) => setCurrentPage(page)}\n\t\t\t/>\n\t\t</Stack>\n\t)\n}\n\nfunction User() {\n\tconst [user, userPending] = useUnit([model.$$user.$user, model.$$user.$userPending])\n\n\tif (userPending) {\n\t\treturn <Spin />\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<UserCard orientation='horizontal' {...user} />\n\t\t</>\n\t)\n}\n"],"names":["createUserMapHistories","$userMapHistories","createStore","$userMapHistoriesPending","getUserMapHistoriesFx","attach","userApi.userMapHistoriesQuery","_","pending","userMapHistories","UserMapHistoryCard","props","index","id","userId","clientId","clientName","regionId","regionName","plotId","plotName","load","onClick","otherProps","jsxs","Card","jsx","CardBody","Stack","DescriptionText","Text","Spin","Fragment","$settingsProfilePageMounted","createEvent","$settingsProfilePageUnmounted","createTabs","$$user","UserFactory","$$userMapHistories","createUserContracts","sample","$$session.$session","session","SettingsProfilePage","handleMount","handleUnmount","useUnit","model.$settingsProfilePageMounted","model.$settingsProfilePageUnmounted","React","User","UserMapHistories","userMapHistoriesPending","model.$$userMapHistories","maxPage","pages","currentData","currentPage","setCurrentPage","usePagination","userMapHistory","Pagination","page","user","userPending","model.$$user","UserCard"],"mappings":"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"}