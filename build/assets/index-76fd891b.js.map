{"version":3,"file":"index-76fd891b.js","sources":["../../src/entities/user/model/user-clients.ts","../../src/pages/settings-subscribes-clients/model.ts","../../src/pages/settings-subscribes-clients/page.tsx"],"sourcesContent":["import { attach, createStore } from 'effector'\n\nimport { userApi, type UserClient } from '~src/shared/api'\n\nexport function createUserSubscribesClients() {\n\tconst $userClients = createStore<UserClient[]>([])\n\tconst $userClientsPending = createStore<boolean>(false)\n\n\tconst getUserSubscribesClientsFx = attach({\n\t\teffect: userApi.userSubscribeClientsQuery,\n\t})\n\n\t$userClientsPending.on(getUserSubscribesClientsFx.pending, (_, pending) => pending)\n\t$userClients.on(getUserSubscribesClientsFx.doneData, (_, subscribeClients) => subscribeClients)\n\n\treturn { getUserSubscribesClientsFx, $userClients, $userClientsPending }\n}\n\nexport function createUserUnSubscribesClients() {\n\tconst $userClients = createStore<UserClient[]>([])\n\tconst $userClientsPending = createStore<boolean>(false)\n\n\tconst getUserUnSubscribesClientsFx = attach({\n\t\teffect: userApi.userUnSubscribeClientsQuery,\n\t})\n\n\t$userClientsPending.on(getUserUnSubscribesClientsFx.pending, (_, pending) => pending)\n\t$userClients.on(getUserUnSubscribesClientsFx.doneData, (_, subscribeClients) => subscribeClients)\n\n\treturn { getUserUnSubscribesClientsFx, $userClients, $userClientsPending }\n}\n","import { attach, createEvent, sample } from 'effector'\n\nimport { $$session } from '~src/entities/session'\nimport { createUserSubscribesClients, createUserUnSubscribesClients } from '~src/entities/user'\n\nexport const settingsSubscribesClientsPageMounted = createEvent<void>()\nexport const settingsSubscribesClientsPageUnmounted = createEvent<void>()\n\nexport const clientSubscribed = createEvent<number>()\nexport const clientUnSubscribed = createEvent<number>()\n\nexport const $$userSubscribesClients = createUserSubscribesClients()\nexport const $$userUnSubscribesClients = createUserUnSubscribesClients()\n\nconst getUserSubscribesClientsFx = attach({\n\teffect: $$userSubscribesClients.getUserSubscribesClientsFx,\n\tsource: $$session.$session,\n\tmapParams: (params: void, session) => {\n\t\tif (!session) throw new Error('Session is not defined')\n\t\treturn { userId: session.id }\n\t},\n})\nconst getUserUnSubscribesClientsFx = attach({\n\teffect: $$userUnSubscribesClients.getUserUnSubscribesClientsFx,\n\tsource: $$session.$session,\n\tmapParams: (params: void, session) => {\n\t\tif (!session) throw new Error('Session is not defined')\n\t\treturn { userId: session.id }\n\t},\n})\nconst subscribesClientsFx = attach({ effect: $$session.subscribesClientsFx })\nconst unSubscribesClientsFx = attach({ effect: $$session.unSubscribesClientsFx })\n\nsample({\n\tclock: settingsSubscribesClientsPageMounted,\n\ttarget: [getUserSubscribesClientsFx, getUserUnSubscribesClientsFx],\n})\n\nsample({\n\tclock: clientSubscribed,\n\tfn: (clientId) => ({ clientIds: [clientId] }),\n\ttarget: subscribesClientsFx,\n})\n\nsample({\n\tclock: subscribesClientsFx.done,\n\ttarget: [getUserSubscribesClientsFx, getUserUnSubscribesClientsFx],\n})\n\nsample({\n\tclock: clientUnSubscribed,\n\tfn: (clientId) => ({ clientIds: [clientId] }),\n\ttarget: unSubscribesClientsFx,\n})\n\nsample({\n\tclock: unSubscribesClientsFx.done,\n\ttarget: [getUserSubscribesClientsFx, getUserUnSubscribesClientsFx],\n})\n","import { AddIcon, DeleteIcon } from '@chakra-ui/icons'\nimport { Button, Card, CardBody, Stack, Text } from '@chakra-ui/react'\nimport { useUnit } from 'effector-react'\nimport React from 'react'\n\nimport { DescriptionText, Pagination, Spin, usePagination } from '~src/shared/ui'\n\nimport * as model from './model'\n\nexport function SettingsSubscribesClientsPage() {\n\tconst [handleMount, handleUnmount] = useUnit([\n\t\tmodel.settingsSubscribesClientsPageMounted,\n\t\tmodel.settingsSubscribesClientsPageUnmounted,\n\t])\n\n\tReact.useEffect(() => {\n\t\thandleMount()\n\t\treturn () => handleUnmount()\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [])\n\n\treturn (\n\t\t<Stack>\n\t\t\t<Stack minH='md' shadow='md' px='6' py='4'>\n\t\t\t\t<Text fontSize='2xl' fontWeight='bold'>\n\t\t\t\t\tПодписанные клиенты\n\t\t\t\t</Text>\n\t\t\t\t<SubscribesClients />\n\t\t\t</Stack>\n\t\t\t<Stack minH='md' shadow='md' px='6' py='4'>\n\t\t\t\t<Text fontSize='2xl' fontWeight='bold'>\n\t\t\t\t\tОтписанные клиенты\n\t\t\t\t</Text>\n\t\t\t\t<UnSubscribesClients />\n\t\t\t</Stack>\n\t\t</Stack>\n\t)\n}\n\nfunction SubscribesClients() {\n\tconst [subscribesClients, subscribesClientsPending] = useUnit([\n\t\tmodel.$$userSubscribesClients.$userClients,\n\t\tmodel.$$userSubscribesClients.$userClientsPending,\n\t])\n\tconst [handleUnSubscribe] = useUnit([model.clientUnSubscribed])\n\tconst { maxPage, pages, currentData, currentPage, setCurrentPage } = usePagination({\n\t\tdata: subscribesClients,\n\t\tperPage: 5,\n\t\tmaxPages: 5,\n\t})\n\n\tif (subscribesClientsPending) {\n\t\treturn <Spin />\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{currentData.map((subscribesClient, index) => (\n\t\t\t\t<Card key={index} variant='filled'>\n\t\t\t\t\t<CardBody>\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<Text fontSize='md' fontWeight='bold'>\n\t\t\t\t\t\t\t\t{subscribesClient.clientName}\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t<DescriptionText title='Деятельность:'>{subscribesClient.clientType}</DescriptionText>\n\t\t\t\t\t\t\t<DescriptionText title='Адрес:'>{subscribesClient.clientAddress}</DescriptionText>\n\t\t\t\t\t\t\t<DescriptionText title='Иин/Бин:'>{subscribesClient.clientIinBin}</DescriptionText>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t<Stack direction='row' justify='end'>\n\t\t\t\t\t\t\t<Button colorScheme='red' onClick={() => handleUnSubscribe(subscribesClient.clientId)}>\n\t\t\t\t\t\t\t\t<DeleteIcon />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</CardBody>\n\t\t\t\t</Card>\n\t\t\t))}\n\n\t\t\t<Pagination\n\t\t\t\tpages={pages}\n\t\t\t\tcurrentPage={currentPage}\n\t\t\t\tonFirstClick={() => setCurrentPage(1)}\n\t\t\t\tonLastClick={() => setCurrentPage(maxPage)}\n\t\t\t\tonPageChange={(newPage) => setCurrentPage(newPage)}\n\t\t\t/>\n\t\t</>\n\t)\n}\n\nfunction UnSubscribesClients() {\n\tconst [unSubscribesClients, unSubscribesClientsPending] = useUnit([\n\t\tmodel.$$userUnSubscribesClients.$userClients,\n\t\tmodel.$$userUnSubscribesClients.$userClientsPending,\n\t])\n\tconst [handleSubscribe] = useUnit([model.clientSubscribed])\n\n\tconst { maxPage, currentData, pages, currentPage, setCurrentPage } = usePagination({\n\t\tdata: unSubscribesClients,\n\t\tperPage: 5,\n\t\tmaxPages: 5,\n\t})\n\n\tif (unSubscribesClientsPending) {\n\t\treturn <Spin />\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{currentData.map((unSubscribesClient, index) => (\n\t\t\t\t<Card key={index} variant='filled'>\n\t\t\t\t\t<CardBody>\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<Text fontSize='md' fontWeight='bold'>\n\t\t\t\t\t\t\t\t{unSubscribesClient.clientName}\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t<DescriptionText title='Деятельность:'>{unSubscribesClient.clientType}</DescriptionText>\n\t\t\t\t\t\t\t<DescriptionText title='Адрес:'>{unSubscribesClient.clientAddress}</DescriptionText>\n\t\t\t\t\t\t\t<DescriptionText title='Иин/Бин:'>{unSubscribesClient.clientIinBin}</DescriptionText>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t<Stack direction='row' justify='end'>\n\t\t\t\t\t\t\t<Button colorScheme='blue' onClick={() => handleSubscribe(unSubscribesClient.clientId)}>\n\t\t\t\t\t\t\t\t<AddIcon />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</CardBody>\n\t\t\t\t</Card>\n\t\t\t))}\n\t\t\t<Pagination\n\t\t\t\tpages={pages}\n\t\t\t\tcurrentPage={currentPage}\n\t\t\t\tonFirstClick={() => setCurrentPage(1)}\n\t\t\t\tonLastClick={() => setCurrentPage(maxPage)}\n\t\t\t\tonPageChange={(newPage) => setCurrentPage(newPage)}\n\t\t\t/>\n\t\t</>\n\t)\n}\n"],"names":["createUserSubscribesClients","$userClients","createStore","$userClientsPending","getUserSubscribesClientsFx","attach","userApi.userSubscribeClientsQuery","_","pending","subscribeClients","createUserUnSubscribesClients","getUserUnSubscribesClientsFx","userApi.userUnSubscribeClientsQuery","settingsSubscribesClientsPageMounted","createEvent","settingsSubscribesClientsPageUnmounted","clientSubscribed","clientUnSubscribed","$$userSubscribesClients","$$userUnSubscribesClients","$$session.$session","params","session","subscribesClientsFx","$$session.subscribesClientsFx","unSubscribesClientsFx","$$session.unSubscribesClientsFx","sample","clientId","SettingsSubscribesClientsPage","handleMount","handleUnmount","useUnit","model.settingsSubscribesClientsPageMounted","model.settingsSubscribesClientsPageUnmounted","React","Stack","jsxs","jsx","Text","SubscribesClients","UnSubscribesClients","subscribesClients","subscribesClientsPending","model.$$userSubscribesClients","handleUnSubscribe","model.clientUnSubscribed","maxPage","pages","currentData","currentPage","setCurrentPage","usePagination","Spin","Fragment","subscribesClient","index","Card","CardBody","DescriptionText","Button","DeleteIcon","Pagination","newPage","unSubscribesClients","unSubscribesClientsPending","model.$$userUnSubscribesClients","handleSubscribe","model.clientSubscribed","unSubscribesClient","AddIcon"],"mappings":"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"}