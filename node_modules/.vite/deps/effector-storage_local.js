import {
  M,
  a,
  ae,
  d,
  mt,
  n,
  p,
  y,
  yt,
  z
} from "./chunk-RGWNF6XI.js";
import "./chunk-TFWDKVI3.js";

// node_modules/.pnpm/effector-storage@5.0.1_effector@22.5.0/node_modules/effector-storage/index.js
var l = /* @__PURE__ */ new Map();
var d2 = d();
function p2(p3) {
  return (y3) => function({ adapter: p4, store: y4, source: k = y4, target: c = y4, clock: m = k, done: v, fail: g = d2, finally: h, pickup: w, key: x, keyPrefix: P = "" }) {
    if (!p4)
      throw Error("Adapter is not defined");
    if (!k)
      throw Error("Store or source is not defined");
    if (!c)
      throw Error("Target is not defined");
    if (!x && k.shortName === k.id)
      throw Error("Key or name is not defined");
    if (k === c && !ae.store(k))
      throw Error("Source must be different from target");
    var E = x || k.shortName, M2 = function(r, o) {
      var t = l.get(r);
      void 0 === t && (t = /* @__PURE__ */ new Map(), l.set(r, t));
      var a3 = t.get(o);
      return void 0 !== a3 || (a3 = p(null, { serialize: "ignore" }), t.set(o, a3)), a3;
    }(p4.keyArea || p4, P + E), b = a(), A = () => mt(b), D = (e4) => ({ status: r, params: o, result: t, error: a3 }) => "done" === r ? { status: r, key: E, keyPrefix: P, operation: e4, value: "get" === e4 ? t : o } : { status: r, key: E, keyPrefix: P, operation: e4, value: o, error: a3 };
    return n(b, () => {
      var e4 = y(), o = y(), t = d(), a3 = t.filterMap(({ status: e5, key: r, keyPrefix: o2, operation: t2, value: a4 }) => "done" === e5 ? { key: r, keyPrefix: o2, operation: t2, value: a4 } : void 0), u = t.filterMap(({ status: e5, key: r, keyPrefix: o2, operation: t2, error: a4, value: i }) => "fail" === e5 ? { key: r, keyPrefix: o2, operation: t2, error: a4, value: i } : void 0), l2 = p4(P + E, e4);
      e4.use(l2.get), o.use(l2.set);
      var d3 = d();
      z({ source: k, clock: m, target: d3 }), M({ source: z(M2, d3, (e5, r) => [r, e5]), filter: ([e5, r]) => e5 !== r, target: o.prepend(([e5]) => e5) }), yt({ from: [e4.doneData, o], to: M2 }), yt({ from: [e4.doneData, M2], to: c }), yt({ from: [e4.finally.map(D("get")), o.finally.map(D("set"))], to: t }), yt({ from: u, to: g }), v && yt({ from: a3, to: v }), h && yt({ from: t, to: h }), w ? yt({ from: w, to: e4.prepend(() => {
      }) }) : e4();
    }), A.unsubscribe = A;
  }({ ...p3, ...y3 });
}
d2.watch((e4) => console.error(e4.error));
var y2 = p2();

// node_modules/.pnpm/effector-storage@5.0.1_effector@22.5.0/node_modules/effector-storage/nil/index.js
function e(e4) {
  var r = () => ({ get() {
  }, set() {
  } });
  return r.keyArea = e4, r;
}

// node_modules/.pnpm/effector-storage@5.0.1_effector@22.5.0/node_modules/effector-storage/storage/index.js
function e2({ storage: e4, sync: t = false, serialize: r = JSON.stringify, deserialize: n3 = JSON.parse }) {
  var a3 = (a4, i) => (t && "undefined" != typeof addEventListener && addEventListener("storage", (t2) => {
    t2.storageArea === e4 && (t2.key === a4 && i(t2.newValue), null === t2.key && i(null));
  }), { get(t2) {
    var r2 = void 0 !== t2 ? t2 : e4.getItem(a4);
    return void 0 === t2 && null === r2 ? void 0 : n3(r2);
  }, set(t2) {
    e4.setItem(a4, r(t2));
  } });
  return a3.keyArea = e4, a3;
}

// node_modules/.pnpm/effector-storage@5.0.1_effector@22.5.0/node_modules/effector-storage/local/index.js
function e3() {
  try {
    return "undefined" != typeof localStorage;
  } catch (r) {
    return false;
  }
}
function n2(n3) {
  return (a3) => y2({ adapter: e3() ? e2({ storage: localStorage, sync: true, ...n3, ...a3 }) : e("local"), ...n3, ...a3 });
}
var a2 = n2();
export {
  n2 as createPersist,
  a2 as persist
};
//# sourceMappingURL=effector-storage_local.js.map
